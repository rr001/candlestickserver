Сервис преобразования биржевых данных в формат достаточный для отрисовки candlestick chart.
  
К сожалению, изза недостатка времени, не получилось использовать Netty, Akka и тп.
Хотя, на мой взгляд, код получился предельно простой.

Недостатки данного решения:
- нет оказоустойчивости. В случае возникновения внутренних ошибоки, поток в котором она произошла, оснановится а другие потоки продолжат работу в пустоту.
- формирование JSON сообщения сделано вручную, что в общем черевато ошибками, но в данном случае приемлемо, так как данные, из которых фомируется JSON, имеют предсказуемый вид.


1. Стурктура.

  TCP-соединение, через 
  которое приходят
  биржевые данные
       |||
       |||
       |||
       |||
       \V/ 
        V
-----------------------------------------
| 1. Прием пакетов из сокета,           |    
| парсинг биржевых данных               |
| и отправка их в очередь.              |   
|                                       | 
| Выполняется в одном, отдельном потоке.|
|                                       | 
| TradingDataReceiverRunner             |   
| TradingDataReaderService              |
-----------------------------------------
        |
        |
     очередь tradingDataQueue (java.util.concurrent.LinkedBlockingQueue)
     данные - объекты TradingData   
        |
        |
        V
----------------------------------------
| 2. Прием биржевых данных и            | 
| формирование свечей (CandlestickData) | 
| отправка готовых свечей в очередь     |
|                                       | 
| Выполняется в одном, отдельном потоке |
|                                       | 
| CandlestickDataAggregatorRunner       |  
| CandlestickDataAggregatorService      | 
----------------------------------------
        |
        |
     очередь candlestickDataQueue (java.util.concurrent.LinkedBlockingQueue)
     данные - объекты CandlestickData   
        |
        |
        V
------------------------------------------
| 3. Передача готовых свечей на отправку | 
| потребителям.                          |        
| Хранение истории за последние 10 минут.|
|                                        | 
| Выполняется в одном, отдельном потоке. |
|                                        | 
| CandlestickDataDistributorRunner       |
| CandlestickDataHistoryService          |--------------------------
| CandlestickDataDistributorService      |                         | 
------------------------------------------                         | 
           |    |    |                                             |
           |    |    |                                  создает канал отправки 
           |    |    |                                             |
  отдельные очереди для каждого                                    |
  потребителя                                                      |
  (java.util.concurrent.ConcurrentLinkedQueue)                     |                            
  данные - объекты CandlestickData                                 V                     
           |    |    |                  --------------------------------------------------                                            
           |    |    |                  |                                                |
           |    |    |                  |                                       создает SocketChannel
           V    V    V                  V                                                | 
    ------------------------------------------                      -----------------------------------------
    | 4. Каналы отправки свечей потребителям |                      | 5.Серверный сокет для подключения     |
    | каждая отправка выполняется в          |                      | новых потребителей                    |
    | отдельном потоке, взятом из пула,      |                      |                                       |
    | через ExecutorService.                 |                      |  выполняется в отдельном потоке       |
    | CandlestickDistributionChannel         |                      |                                       |
    ------------------------------------------                      | CandlestickServerSocketListenerRunner |
                       |||                                          -----------------------------------------
                       |||                                                              /|\
                       |||                                                               |
                       |||                                                               |  
                  TCP-соединение                                                  открывает TCP  
                       |||                                                               |
                       |||        -------------------------------------------------------|
                       |||        |
                       |||        |
                       \V/        |
                        V         |
                  ---------------------
                  |    Потребитель    |
                  ---------------------
               

2. Описание.
   
Каждая из операций 1,2,3 и 5 (см структуру) выполняются в своем фиксированном потоке, который запускается при запуске сервера 
и останавливается при его остановке. 

Для передачи данных от одной операции к другой используются потокобезопасные очереди.

Каждая отправка готовых свечей потребителю, выполняется в отдельном потоке взятом из пула. Это позволяет увеличить производительность, при подключении большего количества потребителей, расширением пула. Других сведств увеличения производительности нет.

При формировании свечей учитывается, что биржевые данные могут приходить из источника с задержкой. Время задержки задается в конфигурационном файле, значение  tradingDataTimeout.

Ожидается что источник биржевых данных присылает их стого в порядке значей timespamp (для одного тикера).

3. Использованные библиотеки.
springframework

Для тестирования используется junit и mockito 

Полноценные тесты не делал.

4. Сборка 
Сборка мавеном, mvn build.
Формируется дистрибутивный пакет candleserver-1.0-bin, в котором
 bin\
   _runclass.bat - вспомогательный bat-файл
   candlestickserver.bat - запускает сервис
   testcandlestickclient.bat - запускает потребителя свечей
 conf\
   candlestickserver.properties - конфигурационный файл
 lib\
   все зависимости
   

